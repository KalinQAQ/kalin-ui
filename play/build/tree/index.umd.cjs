(function(m,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(m=typeof globalThis<"u"?globalThis:m||self,e(m.index={},m.vue))})(this,function(m,e){"use strict";function E(n){return n.install=function(s){const{name:o}=n;s.component(o,n)},n}function B(n,s,o,f){return s&&(n+=`-${s}`),o&&(n+=`__${o}`),f&&(n+=`--${f}`),n}function q(n){return{b:(l="")=>B(n,l,"",""),e:(l="")=>l?B(n,"",l,""):"",m:(l="")=>l?B(n,"","",l):"",be:(l="",d="")=>l&&d?B(n,l,d,""):"",bm:(l="",d="")=>l&&d?B(n,l,"",d):"",em:(l="",d="")=>l&&d?B(n,"",l,d):"",bem:(l="",d="",k="")=>l&&d&&k?B(n,l,d,k):"",is:(l,d)=>d?`is-${l}`:""}}function N(n){const s=`k-${n}`;return q(s)}const T={data:{type:Array,default:()=>[]},defaultExpandedKeys:{type:Array,default:()=>[]},laelField:{type:String,default:"label"},keyField:{type:String,default:"key"},childrenField:{type:String,default:"children"},onLoad:Function,selectedKeys:{type:Array},selectable:{type:Boolean,default:!0},multiple:{type:Boolean,default:!1},showCheckbox:{type:Boolean,default:!1},defaultCheckedKeys:{type:Array,default:()=>[]}},M={node:{type:Object,required:!0},expanded:{type:Boolean,required:!0},loadingKeys:{type:Object,required:!0},selectedKeys:{type:Array,default:[]},showCheckbox:{type:Boolean,required:!1},checked:Boolean,disabled:Boolean,indeterminate:Boolean},x={toggle:n=>n,select:n=>n,check:(n,s)=>typeof s=="boolean"},j={"update:selectedKeys":n=>n},V=Symbol(),P={node:{type:Object,required:!0}},I=e.defineComponent({name:"Switcher",render(){return e.createVNode("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},[e.createVNode("path",{d:"M12 8l10 8l-10 8z"},null)])}}),O={color:String,size:[Number,String]},D=e.defineComponent({name:"k-icon"}),U=e.defineComponent({...D,props:O,setup(n){const s=n,o=N("icon"),f=e.computed(()=>!s.size&&!s.color?{}:{...s.size?{"font-size":s.size+"px"}:{},...s.color?{color:s.color}:{}});return(h,u)=>(e.openBlock(),e.createElementBlock("i",{class:e.normalizeClass(e.unref(o).b()),style:e.normalizeStyle(f.value)},[e.renderSlot(h.$slots,"default")],6))}}),W=E(U),G=e.defineComponent({name:"Loading",render(){return e.createVNode("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024",class:"loading"},[e.createVNode("path",{d:"M512 1024c-69.1 0-136.2-13.5-199.3-40.2C251.7 958 197 921 150 874c-47-47-84-101.7-109.8-162.7C13.5 648.2 0 581.1 0 512c0-19.9 16.1-36 36-36s36 16.1 36 36c0 59.4 11.6 117 34.6 171.3c22.2 52.4 53.9 99.5 94.3 139.9c40.4 40.4 87.5 72.2 139.9 94.3C395 940.4 452.6 952 512 952c59.4 0 117-11.6 171.3-34.6c52.4-22.2 99.5-53.9 139.9-94.3c40.4-40.4 72.2-87.5 94.3-139.9C940.4 629 952 571.4 952 512c0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 0 0-94.3-139.9a437.71 437.71 0 0 0-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.2C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7c26.7 63.1 40.2 130.2 40.2 199.3s-13.5 136.2-40.2 199.3C958 772.3 921 827 874 874c-47 47-101.8 83.9-162.7 109.7c-63.1 26.8-130.2 40.3-199.3 40.3z",fill:"currentColor"},null)])}}),H=e.defineComponent({name:"KTreeNodeContent",props:P,setup(n){const s=e.inject(V),o=e.toRef(n,"node");return()=>s!=null&&s.slots.default?s==null?void 0:s.slots.default({node:o.value}):o.value.label}}),J={modelValue:{type:[Boolean,String,Number]},indeterminate:Boolean,disabled:Boolean,label:{type:String}},Q={"update:modelValue":n=>typeof n=="boolean",change:n=>typeof n=="boolean"},X=["disabled","value"],Y=e.defineComponent({name:"k-checkbox"}),Z=e.defineComponent({...Y,props:J,emits:Q,setup(n,{emit:s}){const o=n,f=N("checkbox"),h=e.ref(),u=e.computed({get(){return o.modelValue},set(c){s("update:modelValue",c)}});function p(c){h.value.indeterminate=c}function g(c){const d=!!c.target.checked;s("change",d)}return e.watch(()=>o.indeterminate,p),e.onMounted(()=>{p(o.indeterminate)}),(c,l)=>(e.openBlock(),e.createElementBlock("label",{class:e.normalizeClass(e.unref(f).b())},[e.createElementVNode("span",{class:e.normalizeClass(e.unref(f).e("input"))},[e.withDirectives(e.createElementVNode("input",{ref_key:"inputRef",ref:h,"onUpdate:modelValue":l[0]||(l[0]=d=>u.value=d),type:"checkbox",disabled:c.disabled,value:c.label,onChange:g},null,40,X),[[e.vModelCheckbox,u.value]])],2),c.$slots.default||c.label?(e.openBlock(),e.createElementBlock("span",{key:0,class:e.normalizeClass(e.unref(f).e("label"))},[e.renderSlot(c.$slots,"default"),c.$slots.default?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createTextVNode(e.toDisplayString(c.label),1)],64))],2)):e.createCommentVNode("",!0)],2))}}),v=E(Z),ee=e.defineComponent({__name:"treeNode",props:M,emits:x,setup(n,{emit:s}){const o=n,f=N("tree-node");function h(){s("toggle",o.node)}const u=e.computed(()=>{var l;return(l=o.loadingKeys)==null?void 0:l.has(o.node.key)}),p=e.computed(()=>o.selectedKeys.includes(o.node.key)),g=l=>{l!=null&&l.disabled||s("select",l)};function c(l){s("check",o.node,l)}return e.inject(V),(l,d)=>{var k;return e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass([e.unref(f).b(),e.unref(f).is("selected",p.value),e.unref(f).is("disabled",l.node.disabled)])},[e.createElementVNode("div",{class:e.normalizeClass([e.unref(f).e("content")]),style:e.normalizeStyle({paddingLeft:`${l.node.level*16}px`})},[e.createElementVNode("span",{class:e.normalizeClass([e.unref(f).e("expand-icon"),{expanded:l.expanded&&!((k=l.node)!=null&&k.isLeaf)},e.unref(f).is("leaf",l.node.isLeaf)]),onClick:h},[e.createVNode(e.unref(W),{size:"25",color:"pink"},{default:e.withCtx(()=>[u.value?(e.openBlock(),e.createBlock(e.unref(G),{key:1})):(e.openBlock(),e.createBlock(e.unref(I),{key:0}))]),_:1})],2),l.showCheckbox?(e.openBlock(),e.createBlock(e.unref(v),{key:0,disabled:l.disabled,"model-value":l.checked,indeterminate:l.indeterminate,onChange:c},null,8,["disabled","model-value","indeterminate"])):e.createCommentVNode("",!0),e.createElementVNode("span",{class:e.normalizeClass(e.unref(f).e("label")),onClick:d[0]||(d[0]=w=>g(l.node))},[e.createVNode(e.unref(H),{node:l.node},null,8,["node"])],2)],6)],2)}}}),te=e.defineComponent({name:"KVirtualList",props:{size:{type:Number,default:35},remain:{default:8,type:Number},items:{type:Array,default:()=>[]}},setup(n,{slots:s}){const o=N("vl"),f=e.ref(),h=e.ref(),u=e.reactive({start:0,end:n.remain}),p=e.computed(()=>Math.min(u.start,n.remain)),g=e.computed(()=>Math.min(n.remain,n.items.length-u.end)),c=e.computed(()=>n.items.slice(u.start-p.value,u.end+g.value)),l=e.ref(0),d=()=>{const w=f.value.scrollTop;u.start=Math.floor(w/n.size),u.end=u.start+n.remain,l.value=u.start*n.size-n.size*p.value};function k(){f.value.style.height=n.remain*n.size+"px",h.value.style.height=n.items.length*n.size+"px"}return e.watch(()=>n.items,()=>k()),e.onMounted(()=>k()),()=>e.createVNode("div",{class:o.b(),ref:f,onScroll:d},[e.createVNode("div",{class:o.e("scroll-bar"),ref:h},null),e.createVNode("div",{class:o.e("scroll-list"),style:{transform:`translate3d(0,${l.value}px,0)`}},[c.value.map((w,R)=>s.default({node:w}))])])}}),ne=e.defineComponent({name:"k-tree"}),le=e.defineComponent({...ne,props:T,emits:j,setup(n,{emit:s}){const o=n,f=N("tree"),h=e.ref([]);function u(t,a,r){return{getKey(i){return i[t]},getLabel(i){return i[a]},getChildren(i){return i[r]}}}const p=u(o.keyField,o.laelField,o.childrenField);function g(t,a=null){function r(y,C=null){return y.map(b=>{const L=p.getChildren(b)||[],_={key:p.getKey(b),label:p.getLabel(b),children:[],rawNode:b,level:C?C.level+1:0,disabled:!!b.disabled,isLeaf:b.isLeaf??L.length==0,parentKey:C==null?void 0:C.key};return L.length>0&&(_.children=r(L,_)),_})}return r(t,a)}e.watch(()=>o.data,t=>{h.value=g(t)},{immediate:!0});const c=e.ref(new Set(o.defaultExpandedKeys)),l=e.computed(()=>{const t=c.value,a=[],r=h.value||[],i=[];for(let y=r.length-1;y>=0;--y)i.push(r[y]);for(;i.length;){const y=i.pop();if(y&&(a.push(y),t.has(y.key)&&y.children))for(let b=y.children.length-1;b>=0;--b)i.push(y.children[b])}return a});function d(t){return c.value.has(t.key)}function k(t){c.value.delete(t.key)}const w=e.ref(new Set);function R(t){if(!t.children.length&&!t.isLeaf){const a=w.value;if(!a.has(t.key)){a.add(t.key);const{onLoad:r}=o;r&&r(t.rawNode).then(i=>{t.rawNode.children=i,t.children=g(i,t),a.delete(t.key)})}}}function ae(t){c.value.add(t.key),R(t)}function se(t){c.value.has(t.key)&&!w.value.has(t.key)?k(t):ae(t)}const S=e.ref([]);e.watch(()=>o.selectedKeys,t=>{t&&(S.value=t)},{immediate:!0});function re(t){let a=Array.from(S.value);if(o.selectable){if(o.multiple){const r=a.findIndex(i=>i===t.key);r>-1?a.splice(r,1):a.push(t.key)}else a.includes(t.key)?a=[]:a=[t.key];s("update:selectedKeys",a)}}e.provide(V,{slots:e.useSlots()});const K=e.ref(new Set(o.defaultCheckedKeys));function ce(t){return K.value.has(t.key)}function de(t){return!!t.disabled}const z=e.ref(new Set);function ie(t){return z.value.has(t.key)}function $(t,a){if(!t)return;const r=K.value;a&&z.value.delete(t.key),r[a?"add":"delete"](t.key);const i=t.children;i&&i.forEach(y=>{y.disabled||$(y,a)})}function F(t){return l.value.find(a=>a.key===t)}function A(t){if(t.parentKey){const a=F(t.parentKey);if(a){let r=!0,i=!1;const y=a.children;for(const C of y)K.value.has(C.key)?i=!0:z.value.has(C.key)?(r=!1,i=!0):r=!1;r?(K.value.add(a.key),z.value.delete(a.key)):i&&(K.value.delete(a.key),z.value.add(a.key)),A(a)}}}function fe(t,a){$(t,a),A(t)}return e.onMounted(()=>{K.value.forEach(t=>{$(F(t),!0)})}),(t,a)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(e.unref(f).b())},[e.createVNode(e.unref(te),{items:l.value,remain:8,size:35},{default:e.withCtx(({node:r})=>[(e.openBlock(),e.createBlock(ee,{key:r.key,node:r,expanded:d(r),"loading-keys":w.value,"selected-keys":S.value,disabled:de(r),"show-checkbox":t.showCheckbox,checked:ce(r),indeterminate:ie(r),onSelect:re,onToggle:i=>se(r),onCheck:fe},null,8,["node","expanded","loading-keys","selected-keys","disabled","show-checkbox","checked","indeterminate","onToggle"]))]),_:1},8,["items"])],2))}}),oe=E(le);m.default=oe,m.treeEmitts=j,m.treeInjectKey=V,m.treeNodeContentProps=P,m.treeNodeEmitts=x,m.treeNodeProps=M,m.treeProps=T,Object.defineProperties(m,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
